name: Add Compiler Label on Issue/PR create

on:
  issues:
    types: [opened]
  pull_request:
    types: [opened]
  

jobs:
  add_compiler_label:
    runs-on: [self-hosted, windows]
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
    
    - name: Add Compiler Label
      uses: actions/github-script@v7
      with:
        script: |
          // get current jai version
          const { createCurrentVersionLabel } = require('./.github/workflows/create_label.js');
          const jai_version = await createCurrentVersionLabel();
          
          const issue_number = context.payload.issue
            ? context.payload.issue.number
            : context.payload.pull_request.number;

          await github.rest.issues.addLabels({
            owner: context.repo.owner,
            repo: context.repo.repo,
            issue_number: issue_number,
            labels: [ '${jai_version}' ]
          });
